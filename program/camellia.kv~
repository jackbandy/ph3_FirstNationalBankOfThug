#:kivy 1.0.9
#:import Factory kivy.factory.Factory


#:set color_button (0.784, 0.443, 0.216, 1)  # brown
#:set color_button_pressed (0.659, 0.522, 0.431, 1)  # darker brown
#:set color_font   (0.957, 0.890, 0.843, 1)  # off white
#:set left_h .083333
#:set right_h 1.0/10.0
#:set right_w 1.0/3.0
#:set cond 1.0/80.0
#:set cond_input 1.0/10.0

#:set pan2_h 1.0/7.0


<MySpinnerOption@SpinnerOption>:
    background_color: color_button if self.state == 'down' else color_button_pressed
    background_down: 'atlas://data/images/defaulttheme/button'
    color: color_font

[Flow@Spinner]:
    id: ctx.id if hasattr(ctx, 'id') else None
    size_hint: 1.0, cond_input
    text: 'Select In/Outflow'
    values: ['Inflow', 'Outflow', 'N/A']
    background_color: color_button if self.state == 'normal' else color_button_pressed
    background_down: 'atlas://data/images/defaulttheme/spinner'
    color: color_font
    option_cls: Factory.get("MySpinnerOption")


<CamelliaWindow>:
    size_hint: 1, 1
    pos_hint: {'center_x': .5, 'center_y': .5}
    do_default_tab: False
    tab_pos: 'top_mid'
    background_color: (1, 0, 0, .5)
    tab_width: root.width/2
    TabbedPanelItem:
        background_color: color_button
        id: creation
        text: 'Creation'
        AnchorLayout:
            anchor_x: 'center'
            anchor_y: 'center'
            size: root.size

            Widget:
                size_hint: 1.0, 1.0

                canvas:
                    Color:
                        rgba: 0, .5, .5, 0.4
                    Rectangle:
                        pos: self.pos
                        size: self.size

            AnchorLayout:
                anchor_x: 'left'
                anchor_y: 'center'
                size_hint: 1.0,1.0
                StackLayout:
                    size_hint: .25, 1.0
                    orientation: 'lr-tb'

                    AnchorLayout:
                        size_hint: 1.0,left_h * 2
                        anchor_x: 'center'
                        anchor_y: 'center'
                        StackLayout:
                            size_hint: 0.9,1.0
                            Label:
                                size_hint: 1.0, 0.15
                            Label:
                                size_hint: 1.0, 0.35
                                text: 'Equation'
                            Spinner:
                                id: eq
                                size_hint: 1.0, 0.35
                                text: 'Navier-Stokes'
                                values: ['Navier-Stokes', 'Stokes']
                                background_color: color_button if self.state == 'normal' else color_button_pressed
                                background_down: 'atlas://data/images/defaulttheme/spinner'
                                color: color_font
                                option_cls: Factory.get("MySpinnerOption")
                            Label:
                                size_hint: 1.0, 0.15

                    AnchorLayout:
                        size_hint: 1.0,left_h * 2
                        anchor_x: 'center'
                        anchor_y: 'center'
                        StackLayout:
                            size_hint: 0.9, 1.0
                            Label:
                                size_hint: 1.0, 0.15
                            Label:
                                size_hint: 1.0, 0.35
                                text: 'Polynomial Order'
                            Spinner:
                                id: poly
                                size_hint: 1.0, 0.35
                                text: '1'
                                values: ['1', '2', '3','4', '5', '6', '7', '8', '9']
                                background_color: color_button if self.state == 'normal' else color_button_pressed
                                background_down: 'atlas://data/images/defaulttheme/spinner'
                                color: color_font
                                option_cls: Factory.get("MySpinnerOption")
                            Label:
                                size_hint: 1.0, 0.15

                    AnchorLayout:
                        size_hint: 1.0,left_h * 2
                        anchor_x: 'center'
                        anchor_y: 'center'
                        StackLayout:
                            size_hint: 0.9, 1.0
                            Label:
                                size_hint: 1.0, 0.15
                            Label:
                                size_hint: 1.0, 0.35
                                text: 'Transient or Steady State'
                            Spinner:
                                id: state
                                size_hint: 1.0, 0.35
                                text: 'Transient'
                                values: ['Transient', 'Steady State']
                                background_color: color_button if self.state == 'normal' else color_button_pressed
                                background_down: 'atlas://data/images/defaulttheme/spinner'
                                color: color_font
                                option_cls: Factory.get("MySpinnerOption")
                            Label:
                                size_hint: 1.0, 0.15

                    AnchorLayout:
                        size_hint: 1.0,left_h * 2
                        anchor_x: 'center'
                        anchor_y: 'center'
                        StackLayout:
                            size_hint: 0.9, 1.0
                            Label:
                                size_hint: 1.0, 0.15
                            Label:
                                size_hint: 1.0, 0.35
                                text: 'Dimensions'
                            TextInput:
                                id: dim_1
                                size_hint: 0.5, 0.35
                                hint_text: '(i.e. 1.0)'
                            TextInput:
                                id: dim_2
                                size_hint: 0.5, 0.35
                                hint_text: '(i.e. 2.0)'
                            Label:
                                size_hint: 1.0, 0.15
                    AnchorLayout:
                        size_hint: 1.0,left_h * 2
                        anchor_x: 'center'
                        anchor_y: 'center'
                        StackLayout:
                            size_hint: 0.9, 1.0
                            Label:
                                size_hint: 1.0, 0.15
                            Label:
                                size_hint: 1.0, 0.35
                                text: 'Mesh Elements'
                            TextInput:
                                id: mesh_1
                                size_hint: 0.5, 0.35
                                hint_text: '(i.e. 3)'
                            TextInput:
                                id: mesh_2
                                size_hint: 0.5, 0.35
                                hint_text: '(i.e. 5)'
                            Label:
                                size_hint: 1.0, 0.15

                    AnchorLayout:
                        size_hint: 1.0,left_h * 2
                        anchor_x: 'center'
                        anchor_y: 'center'
                        StackLayout:
                            size_hint: 0.9, 1.0
                            Label:
                                size_hint: 1.0, 0.15
                            Label:
                                size_hint: 1.0, 0.35
                                text: 'Reynolds Number'
                            TextInput:
                                id: reyn
                                size_hint: 1.0, 0.35
                                hint_text: '(i.e. 800)'
                            Label:
                                size_hint: 1.0, 0.15

            AnchorLayout:
                anchor_x: 'right'
                anchor_y: 'top'
                
                size_hint: 1.0,1.0 
                StackLayout:
                    size_hint: .75, .75
                    orientation: 'lr-tb'
                    Label:
                        size_hint: 1.0, right_h
                        text: 'Flow Conditions'
                        font_size: 20
                    Label:
                        size_hint: right_w, right_h
                        text: 'Position'
                    Label:
                        size_hint: right_w, right_h
                        text: 'Inflow/Outflow'
                    Label:
                        size_hint: right_w, right_h
                        text: 'Function'

                    AnchorLayout:
                        anchor_x: 'center'
                        anchor_y: 'center'
                        size_hint: 1.0/3.0, right_h * 8
                        StackLayout:
                            size_hint: 0.9, 1.0
                            Label:
                                size_hint: 1.0, cond
                            TextInput:
                                id: pos_1
                                size_hint: 1.0, cond_input
                                hint_text: 'i.e. (x = .05, y > 3)'
                            Label:
                                size_hint: 1.0, cond * 2
                            TextInput:
                                id: pos_2
                                size_hint: 1.0, cond_input
                            Label:
                                size_hint: 1.0, cond * 2
                            TextInput:
                                id: pos_3
                                size_hint: 1.0, cond_input
                            Label:
                                size_hint: 1.0, cond * 2
                            TextInput:
                                id: pos_4
                                size_hint: 1.0, cond_input
                            Label:
                                size_hint: 1.0, cond * 2
                            TextInput:
                                id: pos_5
                                size_hint: 1.0, cond_input
                            Label:
                                size_hint: 1.0, cond * 2
                            TextInput:
                                id: pos_6
                                size_hint: 1.0, cond_input
                            Label:
                                size_hint: 1.0, cond * 2
                            TextInput:
                                id: pos_7
                                size_hint: 1.0, cond_input
                            Label:
                                size_hint: 1.0, cond * 2
                            TextInput:
                                id: pos_8
                                size_hint: 1.0, cond_input
                            Label:
                                size_hint: 1.0, cond

                    AnchorLayout:
                        anchor_x: 'center'
                        anchor_y: 'center'
                        size_hint: 1.0/3.0, right_h * 8
                        StackLayout:
                            size_hint: 0.9, 1.0
                            Label:
                                size_hint: 1.0, cond
                            Flow:
                                id: flow_1
                            Label:
                                size_hint: 1.0, cond * 2
                            Flow:
                                id: flow_2
                            Label:
                                size_hint: 1.0, cond * 2
                            Flow:
                                id: flow_3
                            Label:
                                size_hint: 1.0, cond * 2
                            Flow:
                                id: flow_4
                            Label:
                                size_hint: 1.0, cond * 2
                            Flow:
                                id: flow_5
                            Label:
                                size_hint: 1.0, cond * 2
                            Flow:
                                id: flow_6
                            Label:
                                size_hint: 1.0, cond * 2
                            Flow:
                                id: flow_7
                            Label:
                                size_hint: 1.0, cond * 2
                            Flow:
                                id: flow_8
                            Label:
                                size_hint: 1.0, cond
                    AnchorLayout:
                        anchor_x: 'center'
                        anchor_y: 'center'
                        size_hint: 1.0/3.0, right_h * 8
                        StackLayout:
                            size_hint: 0.9, 1.0
                            Label:
                                size_hint: 1.0, cond
                            TextInput:
                                id: func_1
                                size_hint: 0.5, cond_input
                                hint_text: 'x velocity'
                            TextInput:
                                id: func_1b
                                size_hint: 0.5, cond_input
                                hint_text: 'y velocity'
                            Label:
                                size_hint: 1.0, cond * 2
                            TextInput:
                                id: func_2
                                size_hint: 0.5, cond_input
                            TextInput:
                                id: func_2b
                                size_hint: 0.5, cond_input
                            Label:
                                size_hint: 1.0, cond * 2
                            TextInput:
                                id: func_3
                                size_hint: 0.5, cond_input
                            TextInput:
                                id: func_3b
                                size_hint: 0.5, cond_input
                            Label:
                                size_hint: 1.0, cond *2
                            TextInput:
                                id: func_4
                                size_hint: 0.5, cond_input
                            TextInput:
                                id: func_4b
                                size_hint: 0.5, cond_input
                            Label:
                                size_hint: 1.0, cond * 2
                            TextInput:
                                id: func_5
                                size_hint: 0.5, cond_input
                            TextInput:
                                id: func_5b
                                size_hint: 0.5, cond_input
                            Label:
                                size_hint: 1.0, cond * 2
                            TextInput:
                                id: func_6
                                size_hint: 0.5, cond_input
                            TextInput:
                                id: func_6b
                                size_hint: 0.5, cond_input
                            Label:
                                size_hint: 1.0, cond * 2
                            TextInput:
                                id: func_7
                                size_hint: 0.5, cond_input
                            TextInput:
                                id: func_7b
                                size_hint: 0.5, cond_input
                            Label:
                                size_hint: 1.0, cond * 2
                            TextInput:
                                id: func_8
                                size_hint: 0.5, cond_input
                            TextInput:
                                id: func_8b
                                size_hint: 0.5, cond_input
                            Label:
                                size_hint: 1.0, cond
                    

            AnchorLayout:
                anchor_x: 'right'
                anchor_y: 'bottom'
                size_hint: 1.0, 1.0
                AnchorLayout:
                    anchor_x: 'center'
                    anchor_y: 'center'
                    size_hint: .75, .25
                    StackLayout:
                        size_hint: 1.0, 0.85
                        orientation: 'lr-tb'
                        Label:
                            size_hint: 0.04, 1.0
                        Button:
                            id: solve
                            size_hint: 0.44, 1.0
                            text: 'Solve'
                            font_size: 20
                            on_press: dim_2.disabled = True
                            background_color: color_button
                            on_press: root.solve(func_1)
                        Label: 
                            size_hint: 0.04, 1.0
                        Button:
                            id: clear
                            size_hint: 0.44, 1.0
                            text: 'Clear'
                            font_size: 20
                            on_press: dim_2.disabled = True
                            background_color: color_button
                            on_press: root.clear()
                        Label: 
                            size_hint: 0.04, 1.0
                    
                    


    TabbedPanelItem:
        id: solution
        text: 'Solution'
        background_color: color_button
        AnchorLayout:
            anchor_x: 'center'
            anchor_y: 'center'
            size: root.size

            Widget:
                size_hint: 1.0, 1.0

                canvas:
                    Color:
                        rgba: 0, .5, .5, 0.4
                    Rectangle:
                        pos: self.pos
                        size: self.size

            AnchorLayout:
                anchor_x: 'left'
                anchor_y: 'top'
                size_hint: 1.0,1.0
                AnchorLayout:
                    anchor_x: 'center'
                    anchor_y: 'center'
                    size_hint: .25, 1.0
                    StackLayout:
                        size_hint: 0.9, 1.0
                        orientation: 'lr-tb'

                        StackLayout:
                            size_hint: 1.0, pan2_h
                            Label:
                                size_hint: 1.0, 0.1
                            Spinner:
                                id: plot_type
                                size_hint: .48, 0.8
                                text: 'u1'
                                values: ['u1', 'u2', 'p', 'stream', 'mesh', 'error']
                                background_color: color_button if self.state == 'normal' else color_button_pressed
                                background_down: 'atlas://data/images/defaulttheme/spinner'
                                color: color_font
                                option_cls: Factory.get("MySpinnerOption")
                            Label:
                                size_hint: .04, 0.8
                            Button:
                                id: plot
                                size_hint: 0.48, 0.8
                                text: 'Plot'
                                background_color: color_button
                            Label:
                                size_hint: 1.0, 0.1

                        StackLayout:
                            size_hint: 1.0, pan2_h * 2
                            Label: 
                                size_hint: 1.0, 0.085
                            Spinner:
                                id: refine_type
                                size_hint: .48, 0.4
                                text: 'h auto'
                                values: ['h auto', 'h manual', 'p auto', 'p manual']
                                background_color: color_button if self.state == 'normal' else color_button_pressed
                                background_down: 'atlas://data/images/defaulttheme/spinner'
                                color: color_font
                                option_cls: Factory.get("MySpinnerOption")
                            Label:
                                size_hint: .04, 0.4
                            Button:
                                id: refine
                                size_hint: 0.48, 0.4
                                text: 'Refine'
                                background_color: color_button
                            Label:
                                text: 'Elements to Refine:'
                                size_hint: 1.0, 0.23
                            TextInput:
                                id: m_refine
                                size_hint: 1.0, 0.2
                                hint_text: '(0,1,2,5,8,9,10,...)'
                            Label:
                                size_hint: 1.0, 0.085

                        StackLayout:
                            size_hint: 1.0, pan2_h * 2
                            Label: 
                                size_hint: 1.0, 0.085
                            Button:
                                id: load
                                size_hint: 1.0, 0.4
                                text: 'Load'
                                background_color: color_button
                            Label:
                                text: 'Filename (no extension):'
                                size_hint: 1.0, 0.23
                            TextInput:
                                id: load_file
                                size_hint: 1.0, 0.2
                                hint_text: 'CamelliaModel'
                            Label:
                                size_hint: 1.0, 0.085

                        StackLayout:
                            size_hint: 1.0, pan2_h *2
                            Label:
                                size_hint: 1.0, 0.085
                            Button:
                                id: save
                                size_hint: 1.0, 0.4
                                text: 'Save'
                                background_color: color_button
                            Label:
                                text: 'Save as (no extension):'
                                size_hint: 1.0, 0.23
                            TextInput:
                                id: save_file
                                size_hint: 1.0, 0.2
                                hint_text: 'CamelliaModel'
                            Label:  
                                size_hint: 1.0, 0.085

            AnchorLayout:
                anchor_x: 'right'
                anchor_y: 'top'
                size_hint: 1.0,1.0
                StackLayout:
                    size_hint: .75, 1.0
                    orientation: 'lr-tb'
                    Label:
                        size_hint: 1.0, .7
                        text: 'Plot goes here!'
                    Label:
                        size_hint: 1.0, .3
                        text: 'Your error is:'

